<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Book Recommendation System </title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <!-- Font Awesome Icon Library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <style>
    .theme-light {
    background-color: #007bff;
    color: #ffffff;
    border-color: #007bff;
}

.theme-light:hover {
    background-color: #0056b3;
    border-color: #0056b3;
}

/* Dark Theme Button */
.theme-dark {
    background-color: #444;
    color: #ffffff;
    border-color: #444;
}

.theme-dark:hover {
    background-color: #333;
    border-color: #333;
}
       body.light-theme {
            background-color: #ffffff;
            color: #000000;
        }
        .navbar.light-theme {
            background-color: #f8f9fa;
        }

        .sidebar.light-theme {
            background-color: #f8f9fa;
        }

        /* Dark Theme */
        body.dark-theme {
            background-color: #333333;
            color: #ffffff;
        }

        .navbar.dark-theme {
            background-color: #343a40;
        }

        .sidebar.dark-theme {
            background-color: #212529;
        }
      body.light-theme {
            background-color: #ffffff;
            color: #000000;
        }

        .navbar.light-theme {
            background-color: #f8f9fa;
        }

        .sidebar.light-theme {
            background-color: #f8f9fa;
        }

        /* Dark Theme */
        body.dark-theme {
            background-color: #000;
            color: #ffffff;
        }

        .navbar.dark-theme {
            background-color: #343a40;
        }

        .sidebar.dark-theme {
            background-color: #212529;
        }
    /* Light Theme Button */
.theme-light {
    background-color: #007bff;
    color: #ffffff;
    border-color: #007bff;
}

.theme-light:hover {
    background-color: #0056b3;
    border-color: #0056b3;
}

/* Dark Theme Button */
.theme-dark {
    background-color: #444;
    color: #ffffff;
    border-color: #444;
}

.theme-dark:hover {
    background-color: #333;
    border-color: #333;
}
        .rating .fa-star.clicked {
        color: #ffd700; /* Adjust the color as needed */
    }
        .navbar {
            background-color: #343a40;
            position: fixed;
            top: 0;
            right: 0;
            left: 250px;
            width: calc(100% - 250px);
            z-index: 2;
            height: 56px; /* Set a fixed height */
            padding: 0 15px; /* Adjust padding */
        }

        .navbar-brand {
            color: #ffffff;
            font-weight: bold;
        }

        .navbar-nav .nav-link {
            color: #ffffff;
        }

        .navbar-nav .nav-link:hover {
            color: #007bff;
        }

        .sidebar {
            position: fixed;
            top: 0px;
            left: 0;
            height: 100%;
            width: 250px;
            z-index: 1;
            padding-top: 10px;
            background-color: #212529;
        }

        .sidebar a {
            padding: 10px 18px;
            text-decoration: none;
            font-size: 21px;
            color: #ffffff;
            display: block;
            transition: color 0.3s, background-color 0.3s;
        }

        .sidebar a:hover {
            color: #007bff;
            background-color: #292b2c;
        }

        .content {
            margin-left: 290px; /* Adjusted margin */
            padding: 20px;
            margin-top: 56px;
        }

        .sidebar-heading {
            font-size: 1.5rem; /* Adjust the font size as needed */
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .sidebar .nav-link {
            font-size: 1.2rem; /* Adjust the font size as needed */
        }

        .extra-design {
            margin-top: 20px;
            border-top: 1px solid #ddd;
            padding-top: 10px;
        }

        .extra-element {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            color: #555;
        }

        .extra-element i {
            margin-right: 10px;
        }
    </style>
</head>

<body style="background-color:white">
  <nav class="navbar navbar-expand-lg">
    <a class="navbar-brand" href="#">BRS</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
        <ul class="navbar-nav">
            <li class="nav-item">
                <a class="nav-link" href="/my_list">My List</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/signout">Sign Out</a>
            </li>
        </ul>
    </div>
</nav>

    <div class="sidebar">
        <div class="position-sticky">
            <h4 class="text-white text-center mb-4">Book Recommendation System</h4>
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link active" href="/book_recommendation" style="margin-top: 20px;">
                        <i class="fa fa-book"></i> Latest Book Recommendation
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/my_list">
                        <i class="fa fa-list"></i> My List
                    </a>
                </li>
              <li class="nav-item">
        <a class="nav-link" href="/top_50_books">
        <i class="fa fa-book"></i> Top 50 Rated Books
          </a>
              </li>
   <div class="settings-container">
    <div class="dropdown">
        <a class="nav-link" href="#" id="settings-dropdown" role="button" aria-haspopup="true" aria-expanded="false" onclick="toggleDropdown('settings-menu')">
            <i class="fa fa-cogs"></i> Settings
        </a>
        <div class="dropdown-menu" aria-labelledby="settings-dropdown" id="settings-menu">
            <select id="theme-select" onchange="setTheme(this.value)">
                <option value="light">Light Theme</option>
                <option value="dark">Dark Theme</option>
            </select>
        </div>
    </div>
</div>
                <li class="nav-item">
                    <a class="nav-link" href="/About Us">
                        <i class="fa fa-info-circle"></i> About Us
                    </a>
                </li>
            </ul>
            </div>
        </div>
    <div class="content">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="welcome-container">
                        <h1 class="welcome-message">Welcome, {{ username }}</h1>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
          <h1 id="recommendations-heading" class="text-black" style="font-size:35px; font-weight:bold; text-align:center; margin-bottom:20px;">Recommendations</h1>
                    <form action="/recommend_books" method="post" >
                        <input name="user_input" type="text" class="form-control"><br>
                       <input type="submit" class="btn btn-lg btn-warning mb-3 theme-light theme-dark" value="Get Book Recommendation">
                    </form>
                </div>
            </div>
            {% if data %}
                <div class="row">
                    {% for i in data %}
                        <div class="col-md-3" style="width:190px;">
                            <div class="card-body">
                                <div class="card-body">
                                    <img class="card-img-top" src="{{i[2]}}" style="height: 150px; object-fit: cover;">
                                    <h6 class="text-black">{{i[0]}}</h6>
                                    <p class="text-black">{{i[1]}}</p>
                                    <form action="/submit_rating" method="post">
                                        <div class="container">
                                            <div class="rating" id="rating{{ loop.index }}">
                                                <div id="success-message-{{ loop.index }}" style="color: green;"></div>
                                                <span class="fa fa-star" onclick="rate(1, {{ loop.index }})"></span>
                                                <span class="fa fa-star" onclick="rate(2, {{ loop.index }})"></span>
                                                <span class="fa fa-star" onclick="rate(3, {{ loop.index }})"></span>
                                                <span class="fa fa-star" onclick="rate(4, {{ loop.index }})"></span>
                                                <span class="fa fa-star" onclick="rate(5, {{ loop.index }})"></span>
                                            </div>
                                            <input type="hidden" name="BookRating" id="user_rating_{{ loop.index }}" value="0">
                                            <input type="hidden" name="ISBN" value="{{i[3]}}">
                                            <input type="hidden" name="username" value="{{ username }}">
                                        </div> <br>
                                        <input type="submit" class="btn btn-lg mb-3 theme-light theme-dark" value="Submit Rating" style="font-size: 1rem;">
                                    </form>
                                    <!-- Add Book To My List -->
                                    <form action="/add_to_my_list" method="post" class="add-to-list-form">
                                        <input type="hidden" name="username" value="{{ username }}">
                                        <input style="padding-top: 20px" type="hidden" name="book_title" value="{{i[0]}}">
                                        <input type="hidden" name="book_author" value="{{i[1]}}">
                                        <input type="hidden" name="image_url" value="{{i[2]}}">
                                        <input type="checkbox" name="want_to_read" value="1" id="checkbox{{ loop.index }}" class="add-to-list-checkbox">
                                        <label for="checkbox{{ loop.index }}" id="checkboxLabel{{ loop.index }}">Add To My List</label><br>
                                      <input type="submit" class="btn btn-lg" style="font-size: 1rem;" value="Add To My List" />
                                    </form>
                                </div> <br>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
    </div>
  <script>
   var dropdownElementList = [].slice.call(document.querySelectorAll('.dropdown-toggle'));
    var dropdownList = dropdownElementList.map(function (dropdownToggleEl) {
        return new bootstrap.Dropdown(dropdownToggleEl);
    });
    // Internal JavaScript for theme switching
    function setTheme(theme) {
        const body = document.body;
        if (theme === 'dark') {
            body.style.backgroundColor = '#333333';
            body.style.color = '#ffffff';
        } else if (theme === 'light') {
            body.style.backgroundColor = '#ffffff';
            body.style.color = '#000000';
        }

        // Update the theme of the settings button
        const settingsButton = document.getElementById('theme-button');
        if (settingsButton) {
            settingsButton.style.color = (theme === 'dark') ? '#ffffff' : '#000000';
        }

        // Save the user's theme preference
        localStorage.setItem('theme', theme);
    }
 function setTheme(theme) {
        const body = document.body;
        const recommendationsHeading = document.getElementById('recommendations-heading');

        if (theme === 'dark') {
            body.style.backgroundColor = '#000';
            body.style.color = '#ffffff';
            recommendationsHeading.style.color = '#007bff';
        } else if (theme === 'light') {
            body.style.backgroundColor = '#ffffff';
            body.style.color = '#000000';
            recommendationsHeading.style.color = '#007bff';
        }

        // Save the user's theme preference
        localStorage.setItem('theme', theme);
    }
    // Load the user's theme preference on page load
    document.addEventListener('DOMContentLoaded', function() {
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
            setTheme(savedTheme);
        }
    });

    // Event listener for the settings button
    document.getElementById('theme-button').addEventListener('click', function() {
        const currentTheme = localStorage.getItem('theme');
        const newTheme = (currentTheme === 'dark') ? 'light' : 'dark';
        setTheme(newTheme);
    });

    document.getElementById('theme-button').addEventListener('click', function() {
    const currentTheme = localStorage.getItem('theme');
    const newTheme = (currentTheme === 'dark') ? 'light' : 'dark';
    setTheme(newTheme);
    });

    function rate(value, index) {
        var stars = document.querySelectorAll('#rating'+index+' span');
        for (var i = 0; i < stars.length; i++) {
            if (i < value) {
                stars[i].classList.add('clicked');
            } else {
                stars[i].classList.remove('clicked');
            }
        }
        document.getElementById('user_rating_'+index).value = value;
    }

    document.querySelectorAll('.add-to-list-form').forEach(function(form) {
        form.addEventListener('submit', function(event) {
            event.preventDefault();

            var formData = new FormData(this);

            fetch('/add_to_my_list', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Book added to your list successfully!');
                } else {
                    alert('Error adding book to your list. Please try again.');
                }
            })
            .catch(error => {
                // Handle error here if needed
            });
        });
    });

    document.getElementById('expandBtn').addEventListener('click', function() {
        let nav = document.querySelector('.navbar-collapse');
        if (nav.classList.contains('show')) {
            nav.classList.remove('show');
        } else {
            nav.classList.add('show');
        }
    });

    document.querySelectorAll('.rating-form').forEach(function(form) {
        form.addEventListener('submit', function(event) {
            event.preventDefault();
            submitRatingForm(this);
        });
    });

    function submitRatingForm(form) {
        var formData = new FormData(form);

        fetch('/submit_rating', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                var successMessage = form.querySelector('.success-message');
                successMessage.innerText = 'Rating submitted successfully!';
            } else {
                // Handle error here if needed
            }
        });
    }
function toggleDropdown(id) {
    var dropdownMenu = document.getElementById(id);
    dropdownMenu.classList.toggle("show");
}

function setTheme(theme) {
    const body = document.body;
    if (theme === 'dark') {
        body.style.backgroundColor = '#333333';
        body.style.color = '#ffffff';
    } else if (theme === 'light') {
        body.style.backgroundColor = '#ffffff';
        body.style.color = '#000000';
    }

    // Save the user's theme preference
    localStorage.setItem('theme', theme);
}

// Load the user's theme preference on page load
document.addEventListener('DOMContentLoaded', function() {
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) {
        setTheme(savedTheme);
    }
});
function setTheme(theme) {
    const body = document.body;
    const recommendationsHeading = document.getElementById('recommendations-heading');

    if (theme === 'dark') {
        body.style.backgroundColor = '#333333';
        body.style.color = '#ffffff';
        recommendationsHeading.style.color = '#007bff';
    } else if (theme === 'light') {
        body.style.backgroundColor = '#ffffff';
        body.style.color = '#000000';
        recommendationsHeading.style.color = '#007bff';
    }

    // Save the user's theme preference
    localStorage.setItem('theme', theme);
}
</script>
    <!-- Add Bootstrap and other JavaScript links here -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha384-Cz3VIR6HYlDVwEMCpv9a5Z4G6F5gI2YNpRUcvPczfWthwz6X5ZCIOkZ2ZzB2KKmT" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMzQGKHtr4JSzWz3mN7v9ahNqfu0sRLfRj44C2GGb2e2zSwlJ8HIttvJ9id" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.min.js" integrity="sha384-NkN2PexvBq0o2ByxRzQ1JGvwhLoI2YLFrn9UY2iBPW4DHbmshM+7jkNEI/E5E4EQ" crossorigin="anonymous"></script>
</body>
</body>
</html>
